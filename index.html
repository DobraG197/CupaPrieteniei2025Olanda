<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <title>Turneu cu faze eliminatorii</title>
  <style>
    body {

  background-image: url('https://github.com/DobraG197/CupaPrieteniei2025Olanda/blob/main/Cupa%20Prieteniei_%20Handshake%20at%20Footy%20Park.png');
  background-size: 300px 300px;  /* this sets tile size */
  background-repeat: repeat;     /* repeat in both directions */
  background-position: top left; /* optional */
  font-family: Arial, sans-serif;
  padding: 10px;
    }
    h1, h2 {
      text-align: center;
      color: #fff;
      text-shadow: 1px 1px 3px #000;
    }
    .section {
      background: rgba(255, 255, 255, 0.9);
      padding: 20px;
      margin: 20px auto;
      max-width: 1000px;
      border-radius: 8px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      margin: 10px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }
    input[type='number'] {
      width: 50px;
    }
  </style>
</head>
<body>
  <h1>Turneu de Fotbal - Grupe și Eliminatorii</h1>

  <div class="section">
    <button onclick="startDraw()">Trage la sorți</button>
    <div id="grupe"></div>
    <div id="clasamente"></div>
  </div>

  <div class="section">
    <h2>Meciuri din Grupe</h2>
    <div id="meciuriGrupe"></div>
  </div>

  <div class="section">
    <button onclick="genereazaEliminatorii()">Generează fazele eliminatorii</button>
    <h2>Sferturi de Finală</h2>
    <div id="sferturi"></div>
    <h2>Semifinale</h2>
    <div id="semifinale"></div>
    <h2>Finală Mică</h2>
    <div id="finalaMica"></div>
    <h2>Finală Mare</h2>
    <div id="finalaMare"></div>
  </div>

  <script>
    const echipe = ["F.C. Urban Construct", "VidaXL", "Leerdam sport", "Young Stars", "FC. Dosko", "FC. Eagles", "FC. Raiders Amsterdam", "FC. Wariors", "FC. Hunters", "FC. Rilland", "CSM Unirea", "FC. Peppy", "FC Concrete Berești", "Shadow FC", "FC Tilburg", "Amicii"];

    let grupeGlobale = {};
    let statistici = {};
    const terenuri = ["Terenul 4", "Terenul 5"];
    const durataRunda = 25;
    let sferturiWinners = [];
    let finalaMareTeams = [];
    let finalaMicaTeams = [];

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function startDraw() {
      const mix = shuffle([...echipe]);
      grupeGlobale = {
        "Grupa A": mix.slice(0, 4),
        "Grupa B": mix.slice(4, 8),
        "Grupa C": mix.slice(8, 12),
        "Grupa D": mix.slice(12, 16)
      };
      localStorage.setItem("grupe_turneu", JSON.stringify(grupeGlobale));
      afiseazaGrupe();
      afiseazaClasamente();
      programeazaMeciuri();
    }

    function afiseazaGrupe() {
      const div = document.getElementById("grupe");
      div.innerHTML = "";
      for (const g in grupeGlobale) {
        div.innerHTML += `<div><h3>${g}</h3><ul>` + grupeGlobale[g].map(e => `<li>${e}</li>`).join("") + "</ul></div>";
      }
    }

    function afiseazaClasamente() {
      const div = document.getElementById("clasamente");
      div.innerHTML = "";
      for (const g in grupeGlobale) {
        let tabela = `<h4>${g}</h4><table id="clasament-${g}">
        <tr><th>Echipă</th><th>MJ</th><th>V</th><th>E</th><th>Î</th><th>GM</th><th>GP</th><th>GV</th><th>P</th></tr>`;
        grupeGlobale[g].forEach(echipa => {
          tabela += `<tr id="stat-${g}-${echipa}">
            <td>${echipa}</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td>
          </tr>`;
        });
        tabela += "</table>";
        div.innerHTML += tabela;
      }
    }

    function initStats(grupa, echipa) {
      if (!statistici[grupa]) statistici[grupa] = {};
      if (!statistici[grupa][echipa]) statistici[grupa][echipa] = {
        MJ: 0, V: 0, E: 0, I: 0, GM: 0, GP: 0, GV: 0, P: 0
      };
    }

    function updateTable(grupa) {
      const stats = statistici[grupa];
      const entries = Object.entries(stats);
      entries.sort((a, b) => b[1].P - a[1].P || b[1].GV - a[1].GV || b[1].GM - a[1].GM);
      entries.forEach(([echipa, s]) => {
        const row = document.getElementById(`stat-${grupa}-${echipa}`);
        if (row) {
          row.innerHTML = `<td>${echipa}</td><td>${s.MJ}</td><td>${s.V}</td><td>${s.E}</td><td>${s.I}</td>
            <td>${s.GM}</td><td>${s.GP}</td><td>${s.GV}</td><td>${s.P}</td>`;
        }
      });
    }

    function salveazaScor(grupa, e1, e2, id) {
      const g1 = parseInt(document.getElementById(`goluri-${id}-1`).value);
      const g2 = parseInt(document.getElementById(`goluri-${id}-2`).value);
      initStats(grupa, e1); initStats(grupa, e2);
      const s1 = statistici[grupa][e1];
      const s2 = statistici[grupa][e2];

      s1.MJ++; s2.MJ++;
      s1.GM += g1; s1.GP += g2;
      s2.GM += g2; s2.GP += g1;
      s1.GV = s1.GM - s1.GP;
      s2.GV = s2.GM - s2.GP;

      if (g1 > g2) { s1.V++; s2.I++; s1.P += 3; }
      else if (g2 > g1) { s2.V++; s1.I++; s2.P += 3; }
      else { s1.E++; s2.E++; s1.P += 1; s2.P += 1; }

      updateTable(grupa);
      document.getElementById(`meci-${id}`).classList.add("completed");
    }

    function programeazaMeciuri() {
      const toate = [];
      for (const g in grupeGlobale) {
        const lista = grupeGlobale[g];
        for (let i = 0; i < lista.length; i++) {
          for (let j = i + 1; j < lista.length; j++) {
            toate.push({ grupa: g, echipa1: lista[i], echipa2: lista[j] });
          }
        }
      }

      const rounds = [], queue = [...toate], istoric = {}, start = new Date(); start.setHours(10,0,0,0);
      let runda = 0;

      while (queue.length > 0) {
        const set = [], ocupate = new Set();
        for (let t = 0; t < 2; t++) {
          for (let i = 0; i < queue.length; i++) {
            const m = queue[i];
            const { echipa1, echipa2 } = m;
            if ((!istoric[echipa1]?.includes(runda-1)) && (!istoric[echipa2]?.includes(runda-1))
                && !ocupate.has(echipa1) && !ocupate.has(echipa2)) {
              set.push(m);
              ocupate.add(echipa1); ocupate.add(echipa2);
              istoric[echipa1] = istoric[echipa1] || []; istoric[echipa1].push(runda);
              istoric[echipa2] = istoric[echipa2] || []; istoric[echipa2].push(runda);
              queue.splice(i, 1); break;
            }
          }
        }
        rounds.push(set);
        runda++;
      }

      const div = document.getElementById("meciuriGrupe");
      div.innerHTML = "";
      let count = 1;

      rounds.forEach((set, i) => {
        const ora = new Date(start.getTime() + i * durataRunda * 60000).toLocaleTimeString([], {hour: '2-digit', minute: '2-digit'});
        set.forEach((meci, j) => {
          const t = terenuri[j];
          div.innerHTML += `
            <div class='match-item' id="meci-${count}">
              <span><strong>${ora}</strong> | ${meci.grupa} | <strong>${meci.echipa1}</strong> vs <strong>${meci.echipa2}</strong> | ${t}</span>
              <input type="number" id="goluri-${count}-1" min="0" value="0"> -
              <input type="number" id="goluri-${count}-2" min="0" value="0">
              <button onclick="salveazaScor('${meci.grupa}','${meci.echipa1}','${meci.echipa2}', ${count})">Salvează</button>
            </div>`;
          count++;
        });
      });
    }

    function genereazaEliminatorii() {
      const sferturi = [];
      for (const g in grupeGlobale) {
        const groupTeams = grupeGlobale[g];
        const sortedTeams = groupTeams.sort((a, b) => {
          const statsA = statistici[g][a];
          const statsB = statistici[g][b];
          return statsB.P - statsA.P || statsB.GV - statsA.GV || statsB.GM - statsA.GM;
        });
        sferturi.push(sortedTeams[0], sortedTeams[1]);
      }

      const sferturiShuffled = shuffle([...sferturi]);
      const sferturiMatches = [];
      for (let i = 0; i < sferturiShuffled.length; i += 2) {
        sferturiMatches.push([sferturiShuffled[i], sferturiShuffled[i + 1]]);
      }

      const sferturiDiv = document.getElementById("sferturi");
      sferturiDiv.innerHTML = "";
      sferturiMatches.forEach((match, index) => {
        sferturiDiv.innerHTML += `
          <div class='match-item'>
            <span><strong>Sfert ${index + 1}</strong> | <strong>${match[0]}</strong> vs <strong>${match[1]}</strong></span>
            <input type="number" id="goluri-sfert-${index}-1" min="0" value="0"> -
            <input type="number" id="goluri-sfert-${index}-2" min="0" value="0">
            <button onclick="salveazaScorSfert('${match[0]}', '${match[1]}', ${index})">Salvează</button>
          </div>`;
      });
    }

    function salveazaScorSfert(e1, e2, index) {
      const g1 = parseInt(document.getElementById(`goluri-sfert-${index}-1`).value);
      const g2 = parseInt(document.getElementById(`goluri-sfert-${index}-2`).value);

      const winner = g1 > g2 ? e1 : e2;
      sferturiWinners.push(winner);

      if (sferturiWinners.length === 4) {
        genereazaSemifinale();
      }
    }

    function genereazaSemifinale() {
      const semifinaleMatches = [
        [sferturiWinners[0], sferturiWinners[1]],
        [sferturiWinners[2], sferturiWinners[3]]
      ];

      const semifinaleDiv = document.getElementById("semifinale");
      semifinaleDiv.innerHTML = "";
      semifinaleMatches.forEach((match, index) => {
        semifinaleDiv.innerHTML += `
          <div class='match-item'>
            <span><strong>Semifinala ${index + 1}</strong> | <strong>${match[0]}</strong> vs <strong>${match[1]}</strong></span>
            <input type="number" id="goluri-semifinala-${index}-1" min="0" value="0"> -
            <input type="number" id="goluri-semifinala-${index}-2" min="0" value="0">
            <button onclick="salveazaScorSemifinala('${match[0]}', '${match[1]}', ${index})">Salvează</button>
          </div>`;
      });
    }

    function salveazaScorSemifinala(e1, e2, index) {
      const g1 = parseInt(document.getElementById(`goluri-semifinala-${index}-1`).value);
      const g2 = parseInt(document.getElementById(`goluri-semifinala-${index}-2`).value);

      const winner = g1 > g2 ? e1 : e2;
      const loser = g1 > g2 ? e2 : e1;

      if (index === 0) {
        finalaMareTeams[0] = winner;
        finalaMicaTeams[0] = loser;
      } else {
        finalaMareTeams[1] = winner;
        finalaMicaTeams[1] = loser;
      }

      if (finalaMareTeams.length === 2 && finalaMicaTeams.length === 2) {
        genereazaFinale();
      }
    }

    function genereazaFinale() {
      const finalaMareDiv = document.getElementById("finalaMare");
      finalaMareDiv.innerHTML = `
        <div class='match-item'>
          <span><strong>Finala Mare</strong> | <strong>${finalaMareTeams[0]}</strong> vs <strong>${finalaMareTeams[1]}</strong></span>
          <input type="number" id="goluri-finalaMare-1" min="0" value="0"> -
          <input type="number" id="goluri-finalaMare-2" min="0" value="0">
          <button onclick="salveazaScorFinalaMare('${finalaMareTeams[0]}', '${finalaMareTeams[1]}')">Salvează</button>
        </div>`;

      const finalaMicaDiv = document.getElementById("finalaMica");
      finalaMicaDiv.innerHTML = `
        <div class='match-item'>
          <span><strong>Finala Mică</strong> | <strong>${finalaMicaTeams[0]}</strong> vs <strong>${finalaMicaTeams[1]}</strong></span>
          <input type="number" id="goluri-finalaMica-1" min="0" value="0"> -
          <input type="number" id="goluri-finalaMica-2" min="0" value="0">
          <button onclick="salveazaScorFinalaMica('${finalaMicaTeams[0]}', '${finalaMicaTeams[1]}')">Salvează</button>
        </div>`;
    }

    function salveazaScorFinalaMare(e1, e2) {
      const g1 = parseInt(document.getElementById(`goluri-finalaMare-1`).value);
      const g2 = parseInt(document.getElementById(`goluri-finalaMare-2`).value);
      alert(`Finala Mare: ${g1} - ${g2}\nCampion: ${g1 > g2 ? e1 : e2}`);
    }

    function salveazaScorFinalaMica(e1, e2) {
      const g1 = parseInt(document.getElementById(`goluri-finalaMica-1`).value);
      const g2 = parseInt(document.getElementById(`goluri-finalaMica-2`).value);
      alert(`Finala Mică: ${g1} - ${g2}\nLocul 3: ${g1 > g2 ? e1 : e2}`);
    }
  </script>
</body>
</html>
